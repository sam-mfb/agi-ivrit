[English](README.md)

# agi-ivrit

פרויקט שנועד להקל על תרגום משחקי AGI לעברית. מתחילים עם עותק חוקי של משחק AGI, מכינים אותו לתרגום, מתרגמים לעברית, ואז מקמפלים מחדש את המשחק המתורגם.

הפרויקט הזה מבוסס על הפרויקטים הבאים:

- [AGIHebrew של סגב משכרקי](https://github.com/SegMash/AGIHebrew)
- [צוות adventurebrew](https://github.com/adventurebrew/re-quest)

השינויים העיקריים מהפרויקטים האלה:

- סקריפטים ב-Typescript
- שימוש ב-agikit-slim לדיקומפילציה וקומפילציה דרך CLI
- ממשק React לצפייה ועריכה נוחה של קבצי התרגום

---

## אמ;לק

איך לתרגם משחק AGI:

> **הערה:** אם אתם ממשיכים עבודה על תרגום קיים, הריצו קודם `npm run fetch-translation <name>` (למשל, `npm run fetch-translation sq2`) ודלגו לשלב ה-release.

- התחילו עם כל קבצי ה-AGI המקוריים בתיקיית zip. אפשר להשתמש בקובץ `example.zip` שב-`example/` לניסויים
- העתיקו אותו ל-`project/`
- הריצו `npm run init-translations`
- הריצו `npm run extract-translations`
- הריצו `npm run review:dev`
- גשו ל-http://localhost:3000/agi-ivrit - תרגמו את כל המשפטים
- כשסיימתם לתרגם, ייצאו את כל ה-JSON באמצעות כפתורי ה-Export
- העתיקו אותם ל-`translations/[subdir]` כאשר subdir הוא שם התיקייה שלכם
- צרו קבצי pic, view ו-logic מותאמים באמצעות WinAGI או כלי אחר (ראו דוגמה ב-`translations/example`)
- העתיקו את הקבצים המותאמים לתת-תיקיות המתאימות ב-`translations/[subdir]`
- הריצו `npm run release [subdir]`
- המשחק המתורגם הסופי זמין ב-`project/final/agi-build.zip`
- הוסיפו אותו ל-ScummVM כמשחק fan-made ובדקו. וודאו שהשפה מוגדרת לעברית ושמופעל WORDS.TOK.EXTENDED

---

## סקירת תהליך התרגום

השלבים הבסיסיים בתרגום משחק AGI לעברית:

| שלב | תיאור |
|-----|-------|
| **1. הכנת המשחק** | דיקומפילציה של קבצי ה-AGI המקוריים והמרת כל מחרוזות ההודעות להפניות ממוספרות (למשל, `display(m1)` במקום `display("Hello, World")`) |
| **2. חילוץ טקסט** | חילוץ כל הטקסט באנגלית: (א) הודעות במשחק, (ב) פריטי מלאי, (ג) תיאורי view, (ד) אוצר מילים לפקודות |
| **3. תרגום** | תרגום כל הטקסט לעברית, כולל המחרוזות שחולצו וגם טקסט שמיוצג ויזואלית במשאבי PIC או VIEW |
| **4. שינויי משחק** | התאמת לוגיקת המשחק לתצוגה מימין-לשמאל והתאמות נוספות. למשל, פקודות display צריכות להיות מיושרות לימין, או views צריכים להיות מוצגים במיקומים שונים |
| **5. בנייה מחדש** | ייבוא המחרוזות המתורגמות, העתקת משאבי PIC ו-VIEW חדשים, החלת patches על קבצי logic, העתקת פונט עברי, יצירת קובץ WORDS.TOK.EXTENDED, וקומפילציה מחדש |
| **6. שחרור** | הכנת patch בינארי שמשתמשים עם עותק חוקי יכולים להחיל. הכנת patch ל-ScummVM לזיהוי המשחק כגרסה עברית |

---

## מטרות החבילה

שלבים 3 ו-4 הם הקשים ביותר - שם צריך באמת לתרגם טקסט ולפתח גרפיקה ולוגיקה מותאמים.

מטרת החבילה הזו היא לאוטמט, או לפחות לפשט, את כל השאר.

בפרט, החבילה נועדה:

- לאוטמט שלבים 1, 2 ו-5
- לספק כלים לפישוט שלבים 3, 4 ו-6
- לעשות את כל זה בצורה שלעולם לא גורמת לחומר מוגן בזכויות יוצרים להיכנס ל-version control

> **הערה:** החבילה לא מספקת כלים לעריכת גרפיקה בקבצי PIC ו-VIEW. WinAGI הוא כלי מצוין לכך.

---

## שימוש

### 1. הכנת המשחק

תחילה, תצטרכו קובץ zip שמכיל את כל הקבצים המקומפלים של משחק ה-AGI בשורש. זה יכול להיות, למשל, גרסה מכווצת של תיקיית משחק Sierra שרכשתם ב-GOG.

אם אין לכם כזה או שאתם רק מנסים, אפשר להשתמש במשחק הדוגמה שבריפו ב-`example/example.zip`

**להכנת המשחק:**

1. העתיקו את קובץ ה-zip ל-`project/`
2. הריצו `npm run init-translations`

זה ידקמפל את כל נכסי המשחק ויחליף מחרוזות הודעות בגרסאות ממוספרות.

> תיקיית `project/` כולה מתעלמת על ידי git אז שום דבר פה לא ייכנס ל-version control.

---

### 2. חילוץ טקסט

הריצו:

```bash
npm run extract-translations
```

זה יחלץ את כל המחרוזות הדורשות תרגום לארבעה קבצים בתיקיית `active-translation/`:

| קובץ | תוכן |
|------|------|
| `messages.json` | כל ההודעות במשחק |
| `objects.json` | שמות פריטי המלאי |
| `views.json` | תיאורי view |
| `vocabulary.json` | קבוצות מילים נרדפות לפקודות |

הקבצים פה הם קבצי העבודה שלכם. הם נכנסים ל-version control וכאן תעשו את עבודת התרגום.

---

### 3. תרגום טקסט

אפשר לערוך את קבצי המחרוזות ב-`active-translation/` ישירות עם עורך טקסט, או:

```bash
npm run review:dev
```

זה יפעיל שרת web עם ממשק ידידותי לכתיבת תרגומים, רישום הערות, וייצוא JSON מעודכנים (שתעתיקו חזרה ל-`active-translation/`).

> **טיפ:** אפשר להשתמש ב-`npm run review:build` לבניית גרסה שאפשר לפרסם, למשל כ-GitHub Page, לשיתוף עם מתרגמים אחרים.

---

### 4. שינוי המשחק

באמצעות WinAGI או כלי אחר, צרו את קבצי ה-PIC, VIEW ו-LOGIC המותאמים הדרושים למשחק המתורגם.

כשמוכנים, צרו תת-תיקייה למשחק בתיקיית `translations/`. אם מתכננים לשתף את התרגום, צרו אותו כריפו git נפרד (למשל, `agi-ivrit-sq2`) והגישו PR לריפו הזה להוספה ל-`translations.json` ולטבלת התרגומים הזמינים ב-README.

העתיקו את קבצי ה-`*.json` המוכנים מ-`active-translation/` לתת-תיקייה. צרו גם תת-תיקיות `view/`, `pic/` ו-`logic/` שמכילות:

| תיקייה | תוכן |
|--------|------|
| `view/` | קבצי view בפורמט `.agiview` (מדוקמפל) או `.agv` (WinAGI מקומפל). קבצי `.agiviewdesc` אופציונליים לתיאורים. שמות: `12.agiview`, `View12.agv` וכו' |
| `pic/` | קבצי תמונה בפורמט `.agipic` (מדוקמפל) או `.agp` (WinAGI מקומפל). שמות: `12.agipic`, `Pic12.agp`, `Picture12.agp` וכו' |
| `logic/` | קבצי patch (.patch) שיחולו על קבצי .agilogic |

קבצי WinAGI מקומפלים (`.agv`, `.agp`) עוברים דיקומפילציה אוטומטית בתהליך הבנייה.

---

### 5. בנייה מחדש

הריצו:

```bash
npm run release <translation-name>
```

למשל: `npm run release example`

זה ייבא את כל המחרוזות המתורגמות, יעתיק את הקבצים המותאמים, יחיל patches על קבצי logic, יעתיק פונט עברי, יקמפל מחדש את המשחק, ויארוז ל-zip.

מזל טוב! עכשיו אמורה להיות לכם גרסה עברית של המשחק!

#### בניית פיתוח

אפשר גם להריץ:

```bash
npm run release:dev <translation-name>
```

זה עושה את כל הנ"ל חוץ מאריזה - במקום זה מעתיק את הקבצים הסופיים לתיקיית `play-build/` בשורש הריפו (שמתעלמת על ידי git). שימושי כי אפשר פשוט להפנות את ScummVM לתיקייה הזו לפיתוח ובדיקה מהירים.

---

### 6. שחרור

TODO: יצירת patches ושינוי detection_tables של ScummVM

---

## תרגומים זמינים

תרגומים מתוחזקים בריפוזיטורים נפרדים. לשימוש:

1. שכפלו את הריפו והריצו `npm install`
2. הביאו את התרגום: `npm run fetch-translation <name>`
3. שימו את ה-zip של המשחק שרכשתם בחוקיות ב-`project/`
4. הריצו `npm run init-translations`
5. הריצו `npm run release <name>`

| משחק | ריפו | סטטוס |
|------|------|-------|
| Space Quest II | [agi-ivrit-sq2](https://github.com/sam-mfb/agi-ivrit-sq2) | בתהליך |

> **הערה:** תרגום ה-`example` כלול בריפו הזה למטרות הדגמה.

### פרסום אפליקציית Review

אם אתם מתחזקים ריפו תרגום, אפשר לפרסם אוטומטית את אפליקציית ה-review ל-GitHub Pages כדי שמשתפי פעולה יוכלו לצפות ולדון בתרגומים אונליין.

```bash
npm run install-review-workflow <name>
```

למשל: `npm run install-review-workflow sq2`

זה מתקין workflow של GitHub Actions בריפו התרגום. אחרי commit ו-push, לכו להגדרות הריפו ← Pages והגדירו את המקור ל-"GitHub Actions". אפליקציית ה-review תתעדכן אוטומטית בכל push.
